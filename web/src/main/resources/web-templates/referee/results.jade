extends ../../layout/tournament-layout


block append styles
    style.

        .teams {
            display: grid;
            grid: auto-flow / 1fr 1fr;
        }

        .team {
            padding: 12px;
        }

        .blue h2 {
            color: blue;
        }

        .red h2 {
            color: red;
        }

        h3 small {
            display: block;
            margin-left: 24px;
            font-weight: normal;
        }

        .results {
            margin-left: 24px;
        }

        .missingEsi {
            display: flex;
            flex-wrap: wrap;
        }

        .missingEsi .name + .name {
            margin-left: 20px;
        }

        .split-teams .multi {
            display: flex;
        }

        .split-teams .multi .team + .team {
            margin-left: 20px;
        }

        .comp .not-on-team {
            background: -webkit-linear-gradient(left, darkred 0%, #8b000020 30%, rgba(222, 222, 222, 0) 100%);
        }

mixin results(json)
    .result
        - var noEsi = json.getJsonArray("noEsi")
        if noEsi.size() > 0
            .section
                h3 Missing ESI details
                    small please ask pilot to login to eve.toys and then go back and resubmit
                .missingEsi
                    each name in noEsi
                        .name= name

        - var teams = json.getJsonArray("teams")
        .section
            .split-teams
                h3 Team
                if teams.size() == 1
                    p= teams.getJsonObject(0).getString("team_name")
                else
                    p Squad is made of pilots from multiple teams
                    .multi
                        each team in teams
                            .team #{team.getString("team_name")} (#{team.getInteger("count")})

        .section
            .comp
                h3 Team Composition
                - var comp = json.getJsonArray("comp")
                table.pure-table
                    tbody
                        each pilot in comp
                            tr(class=pilot.getBoolean("onTeam") ? "" : "not-on-team")
                                td= pilot.getString("pilot")
                                td= pilot.getString("ship")



block content
    - var uuid = tournament.getString("uuid")

    mixin subtitle("Referee")

    .teams
        .team.blue
            h2 Blue Team
            mixin results(results.blue)

        .team.red
            h2 Red Team
            mixin results(results.red)

block scripts

