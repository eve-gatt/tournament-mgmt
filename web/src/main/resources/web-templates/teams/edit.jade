extends ../../layout/tournament-layout

block append styles
    style.
        .teammembers table {
            margin-bottom: 12px;
        }

block content
    - var tournamentUuid = tournament.getString("uuid")
    - var teamUuid = team.getString("uuid")
    - var roles = tournament.getString("roles") == null ? "" : tournament.getString("roles")
    - var isSuperuser = character.getBoolean("isSuperuser")
    - var isCaptain = tournament.getBoolean("is_captain")

    mixin subtitle("Edit team")

    h3 Captain: #{team.getString("captain")}

    .teammembers
        .no-teammembers This team doesn't have any members.
        table.pure-table
            thead
                th Name
                th Actions
            tbody

    if (team.getBoolean("locked") && (isSuperuser || roles.contains("organiser"))) || (!team.getBoolean("locked") && (isSuperuser || roles.contains("organiser") || isCaptain))
        a(href="/auth/tournament/" + tournamentUuid + "/teams/" + teamUuid + "/add-members") Add team members
        a(href="/auth/tournament/" + tournamentUuid + "/teams/" + teamUuid + "/lock-team") Lock team
    if team.getBoolean("locked")
        a(href='#') Thunderdome accounts

block scripts
    script.
        const tournamentUuid = '#{tournamentUuid}';
        const teamUuid = '#{teamUuid}';
        const locked = #{team.getBoolean("locked")};
        const isSuperuser = #{character.getBoolean("isSuperuser")};
        const isOrganiser = #{tournament.getString("roles") != null && tournament.getString("roles").contains("organiser")};
        const isCaptain = #{tournament.getBoolean("is_captain")};
        const isPilot = #{tournament.getBoolean("is_pilot")};
    script(src='/js/teams/edit.js')
